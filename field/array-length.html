<link rel="import" href="./config-input.html">
<link rel="import" href="../input/kwc-blockly-array-length.html">
<script>
    Blockly.FieldArrayLength = function (value, opt_validator) {
        this._width = 16;
        this._height = 16;
        Blockly.FieldArrayLength.superClass_.constructor.call(this, value || 0, opt_validator);
    };
    goog.inherits(Blockly.FieldArrayLength, Blockly.FieldConfig);

    Blockly.FieldArrayLength.prototype.showEditor_ = function () {
        Blockly.WidgetDiv.show(this, this.sourceBlock_.RTL, Blockly.FieldArrayLength.widgetDispose_);

        var div = Blockly.WidgetDiv.DIV;
        
        this.customEl = document.createElement('kwc-blockly-array-length');
        this.customEl.value = this.getValue();

        this.customEl.addEventListener('value-changed', (e) => {
            this.setValue(e.detail.value);
        });

        div.appendChild(this.customEl);
        this.position();

        if ('animate' in HTMLElement.prototype) {
            div.animate({
                opacity: [0, 1]
            }, {
                duration: 100,
                easing: 'ease-out'
            });
        }
    };
</script>